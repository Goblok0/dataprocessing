<head>
  <title>BananaSlamma</title>
  <script>
      

  </script>
</head>
<body>
    <script type="text/javascript">
      var data;
      var fileName = "data.json";
      var txtFile = new XMLHttpRequest();
      txtFile.onreadystatechange = function() {
          if (txtFile.readyState === 4 && txtFile.status == 200) {
              data = JSON.parse(txtFile.responseText);

              var totDict = {}

              for (let key of Object.keys(data)){
                console.log(data[key])
                var title = data[key].Title;
                splitted = title.split("(");
                // console.log(splitted)
                var title = splitted[0]
                var year = splitted[1].replace(")","")

                // console.log(year)
                var genres = [];

                if (!(data[key].Genre1.length == 0)){
                  genres.push(data[key].Genre1);
                }
                if (!(data[key].Genre2.length == 0)){
                  genres.push(data[key].Genre2);
                }
                if (!(data[key].Genre3.length == 0)){
                  genres.push(data[key].Genre3);
                }
                // // year-genre-movie
                // if (!totDict[year]){
                //   totDict[year] = {}
                // }
                //
                // var inYear = totDict[year]
                // for (let genre of genres){
                //   if (!(inYear[genre])){
                //     inYear[genre] = []
                //   }
                //   inYear[genre].push(title);
                // }
                // genre-year-movie

                for (let genre of genres){
                  if (!totDict[genre]){
                    totDict[genre] = {}
                  }
                  var inGenre = totDict[genre]

                  if (!(inGenre[year])){
                    inGenre[year] = []
                  }
                  inGenre[year].push(title);
                }
              }
              console.log(totDict)
              var data = []
              for (var genre in totDict){
                // order: genre - year - #movies
                genreData = {}
                yearList = []
                movieList = []

                var inGenre = totDict[genre]
                // console.log(inGenre)
                // console.log(`${genre}`)
                for (const [year, movies] of Object.entries(inGenre)){
                  yearList.push(`x: ${year}`)
                  movieList.push(`y: ${movies.length}`)
                }
                // console.log(genreData)
                genreData.push(`${genre}`);
                genreData.push(yearList)
                genreData.push(movieList)
                data.push(genreData)
              }
              for (genre of data){
                console.log(genre)
                console.log(genre[1])
              }



              // window.onload = function() {
              //   var chart = new CanvasJS.chart("chartContainer",{
              //     title: {
              //             text: "Prevalance of genres in popular movies"
              //     },
              //     axisX: {
              //             valueFormatString: "Year"
              //     },
              //     axisY2: {
              //             title: "Frequency"
              //     },
              //
              //     data: [{
              //       for (genre of data){
              //         type: "line",
              //         name: `${genre}`
              //
              //         dataPoints: [
              //         {
              //
              //         }
              //         ]
              //       }
              //
              //     }
              //     ]
              //   })
              // }
          }
      }

      txtFile.open("GET", fileName);
      txtFile.send();
      // <canvas id="canvas" width="750" height="500"></canvas>
      // chart.render();
    </script>
</body>
